package com.savvasdalkitsis.locationexploit

import android.app.Activity
import android.app.AlertDialog
import android.preference.PreferenceManager
import android.text.SpannableString
import android.text.method.LinkMovementMethod
import android.text.util.Linkify
import android.widget.TextView


object About {
    private const val HAS_SEEN_DIALOG = "HAS_SEEN_DIALOG"

    fun maybeShowDialog(activity: Activity) {
        val prefs = PreferenceManager.getDefaultSharedPreferences(activity)
        if (!prefs.getBoolean(HAS_SEEN_DIALOG, false)) {
            prefs.edit().putBoolean(HAS_SEEN_DIALOG, true).apply()
            showDialog(activity)
        }
    }

    fun showDialog(activity: Activity) {
        AlertDialog.Builder(activity)
                .setTitle(R.string.what_is_this)
                .setMessage(SpannableString(activity.getString(R.string.app_description)).apply {
                    Linkify.addLinks(this, Linkify.ALL)
                })
                .setPositiveButton(android.R.string.ok, { d, _ ->
                    d.dismiss()
                })
                .create().apply {
                    show()
                    findViewById<TextView>(android.R.id.message).movementMethod = LinkMovementMethod.getInstance()
                }
    }

}
